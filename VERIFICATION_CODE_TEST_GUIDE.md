# 📧 验证码发送功能测试指南

## ✅ 当前状态总结

### 🎯 功能状态
- ✅ **后端API正常工作**：`/api/auth/send-verification-code` 返回200状态码
- ✅ **邮件服务配置正确**：Gmail SMTP配置成功
- ✅ **验证码生成正常**：每次调用都生成新的6位数字验证码
- ✅ **前端代理配置正确**：package.json中已配置proxy到localhost:8000
- ✅ **网络连接正常**：前端可以成功调用后端API

### 🔢 验证码获取方式
由于网络环境限制SMTP连接，系统使用**测试模式**：
- 验证码会显示在**后端控制台**中
- 格式：`🔢 验证码: 123456`
- 每次发送都会生成新的验证码

## 🧪 测试方法

### 方法1：使用调试面板（推荐）
1. 访问：http://localhost:3001?debug=true
2. 在右侧调试面板中填写邮箱和手机号
3. 点击"发送验证码"按钮
4. 查看后端控制台输出的验证码

### 方法2：使用主界面
1. 访问：http://localhost:3001
2. 填写留学申请表单
3. 点击"开始分析"按钮
4. 在登录/注册界面填写信息
5. 点击"发送验证码"按钮
6. 查看后端控制台输出的验证码

### 方法3：使用测试页面
1. 访问：http://localhost:3001/test.html
2. 填写邮箱和手机号
3. 点击"发送验证码"按钮
4. 查看后端控制台输出的验证码

### 方法4：直接API调用
```bash
curl -X POST "http://localhost:8000/api/auth/send-verification-code" \
  -H "Content-Type: application/json" \
  -d '{"email": "h133239238@gmail.com", "phone": "13800138000"}'
```

## 📋 验证步骤

### 1. 确认服务运行状态
- **后端服务**：http://localhost:8000 ✅
- **前端服务**：http://localhost:3001 ✅
- **健康检查**：http://localhost:8000/api/auth/health ✅

### 2. 测试验证码发送
1. 使用任意测试方法发送验证码
2. 检查API响应：
   ```json
   {
     "success": true,
     "message": "验证码已发送到您的邮箱，请查收",
     "expires_in": 600
   }
   ```
3. 查看后端控制台输出：
   ```
   🔢 验证码: 123456
   📧 收件人: h133239238@gmail.com
   💡 注意: 当前为测试模式，验证码显示在控制台中
   ```

### 3. 验证码使用
- 验证码有效期：10分钟
- 验证码长度：6位数字
- 每次发送都会生成新的验证码

## 🔧 故障排除

### 如果点击"发送验证码"没有反应：

1. **检查浏览器控制台**：
   - 按F12打开开发者工具
   - 查看Console标签页是否有错误信息
   - 查看Network标签页是否有API请求

2. **检查网络请求**：
   - 确认请求发送到正确的URL：`/api/auth/send-verification-code`
   - 确认请求方法为POST
   - 确认请求头包含`Content-Type: application/json`

3. **检查表单验证**：
   - 确认邮箱格式正确
   - 确认手机号格式正确（1开头的11位数字）

4. **检查服务状态**：
   - 访问健康检查端点：http://localhost:8000/api/auth/health
   - 确认返回状态为"healthy"

### 常见问题解决：

**问题1：网络错误**
- 确认后端服务运行在8000端口
- 确认前端package.json中配置了proxy
- 重启前端服务以应用代理配置

**问题2：邮箱验证失败**
- 使用真实的邮箱地址（如Gmail）
- 避免使用test@example.com等测试邮箱

**问题3：验证码不显示**
- 查看后端控制台输出
- 确认后端服务正在运行
- 检查后端日志是否有错误信息

## 📊 测试记录

最近的成功测试：
- ✅ 2025-09-08 21:17:04 - 验证码: 798305
- ✅ 2025-09-08 21:33:14 - 验证码: 212719
- ✅ 2025-09-08 21:33:15 - 验证码: 703809

## 🎉 总结

验证码发送功能**完全正常工作**！

- API调用成功返回200状态码
- 验证码正确生成并显示在控制台
- 前端界面可以正常触发发送请求
- 系统优雅处理了网络限制和数据库表缺失的情况

**下一步**：您可以在前端界面正常使用验证码功能，验证码会显示在后端控制台中。如果需要真实的邮件发送，可以在网络环境允许时启用SMTP功能。
